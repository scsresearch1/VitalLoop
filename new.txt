## 1. BeanFactory.java

package com.oudmon.ble.base.bluetooth;

import com.oudmon.ble.base.communication.rsp.AppRevisionResp;
import com.oudmon.ble.base.communication.rsp.AppSportRsp;
import com.oudmon.ble.base.communication.rsp.BaseRspCmd;
import com.oudmon.ble.base.communication.rsp.BatteryRsp;
import com.oudmon.ble.base.communication.rsp.BloodOxygenSettingRsp;
import com.oudmon.ble.base.communication.rsp.BloodSugarLipidsSettingRsp;
import com.oudmon.ble.base.communication.rsp.BpDataRsp;
import com.oudmon.ble.base.communication.rsp.BpSettingRsp;
import com.oudmon.ble.base.communication.rsp.CameraNotifyRsp;
import com.oudmon.ble.base.communication.rsp.DegreeSwitchRsp;
import com.oudmon.ble.base.communication.rsp.DeviceAvatarRsp;
import com.oudmon.ble.base.communication.rsp.DeviceNotifyRsp;
import com.oudmon.ble.base.communication.rsp.DeviceSupportFunctionRsp;
import com.oudmon.ble.base.communication.rsp.DisplayTimeRsp;
import com.oudmon.ble.base.communication.rsp.DndRsp;
import com.oudmon.ble.base.communication.rsp.FindPhoneRsp;
import com.oudmon.ble.base.communication.rsp.HRVRsp;
import com.oudmon.ble.base.communication.rsp.HRVSettingRsp;
import com.oudmon.ble.base.communication.rsp.HeartRateSettingRsp;
import com.oudmon.ble.base.communication.rsp.MusicCommandRsp;
import com.oudmon.ble.base.communication.rsp.MuslimRemindRsp;
import com.oudmon.ble.base.communication.rsp.MuslimRsp;
import com.oudmon.ble.base.communication.rsp.MuslimTargetRsp;
import com.oudmon.ble.base.communication.rsp.PackageLengthRsp;
import com.oudmon.ble.base.communication.rsp.PalmScreenRsp;
import com.oudmon.ble.base.communication.rsp.PhoneNotifyRsp;
import com.oudmon.ble.base.communication.rsp.PressureRsp;
import com.oudmon.ble.base.communication.rsp.PressureSettingRsp;
import com.oudmon.ble.base.communication.rsp.ReadAlarmRsp;
import com.oudmon.ble.base.communication.rsp.ReadBlePressureRsp;
import com.oudmon.ble.base.communication.rsp.ReadDetailSportDataRsp;
import com.oudmon.ble.base.communication.rsp.ReadHeartRateRsp;
import com.oudmon.ble.base.communication.rsp.ReadMessagePushRsp;
import com.oudmon.ble.base.communication.rsp.ReadSitLongRsp;
import com.oudmon.ble.base.communication.rsp.ReadSleepDetailsRsp;
import com.oudmon.ble.base.communication.rsp.RealTimeHeartRateRsp;
import com.oudmon.ble.base.communication.rsp.SetTimeRsp;
import com.oudmon.ble.base.communication.rsp.SimpleStatusRsp;
import com.oudmon.ble.base.communication.rsp.StartHeartRateRsp;
import com.oudmon.ble.base.communication.rsp.TargetSettingRsp;
import com.oudmon.ble.base.communication.rsp.TimeFormatRsp;
import com.oudmon.ble.base.communication.rsp.TodaySportDataRsp;
import com.oudmon.ble.base.communication.rsp.TouchControlResp;
import com.oudmon.ble.base.communication.rsp.WeatherForecastRsp;

/* loaded from: classes4.dex */
public class BeanFactory {
    public static BaseRspCmd createBean(int i2, int i3) {
        if (i2 == 1) {
            return new SetTimeRsp();
        }
        if (i2 == 2) {
            return new CameraNotifyRsp();
        }
        if (i2 == 3) {
            return new BatteryRsp();
        }
        if (i2 == 5) {
            return new PalmScreenRsp();
        }
        if (i2 == 6) {
            return new DndRsp();
        }
        if (i2 == 12) {
            return new BpSettingRsp();
        }
        if (i2 == 13) {
            return new BpDataRsp();
        }
        if (i2 == 25) {
            return new DegreeSwitchRsp();
        }
        if (i2 == 26) {
            return new WeatherForecastRsp();
        }
        if (i2 == 33) {
            return new TargetSettingRsp();
        }
        if (i2 == 34) {
            return new FindPhoneRsp();
        }
        if (i2 == 67) {
            return new ReadDetailSportDataRsp();
        }
        if (i2 == 68) {
            return new ReadSleepDetailsRsp();
        }
        if (i2 == 114) {
            return new SimpleStatusRsp();
        }
        if (i2 != 115) {
            switch (i2) {
                case -223:
                    return new AppRevisionResp();
                case 10:
                    return new TimeFormatRsp();
                case 17:
                    return new PhoneNotifyRsp();
                case 38:
                    return new ReadSitLongRsp();
                case 40:
                    return new ReadAlarmRsp();
                case 44:
                    return new BloodOxygenSettingRsp();
                case 47:
                    return new PackageLengthRsp();
                case 50:
                    return new DeviceAvatarRsp();
                case 54:
                    return new PressureSettingRsp();
                case 55:
                    return new PressureRsp();
                case 56:
                    return new HRVSettingRsp();
                case 57:
                    return new HRVRsp();
                case 58:
                    return new BloodSugarLipidsSettingRsp();
                case 59:
                    return new TouchControlResp();
                case 60:
                    return new DeviceSupportFunctionRsp();
                case 72:
                    return new TodaySportDataRsp();
                case 82:
                    return new MuslimRemindRsp();
                case 97:
                    return new ReadMessagePushRsp();
                case 105:
                    return new StartHeartRateRsp();
                case 119:
                    return new AppSportRsp();
                case 120:
                    break;
                case 122:
                    return new MuslimRsp();
                case 123:
                    return new MuslimTargetRsp();
                default:
                    switch (i2) {
                        case 20:
                            return new ReadBlePressureRsp();
                        case 21:
                            return new ReadHeartRateRsp();
                        case 22:
                            return new HeartRateSettingRsp();
                        default:
                            switch (i2) {
                                case 29:
                                    return new MusicCommandRsp();
                                case 30:
                                    return new RealTimeHeartRateRsp();
                                case 31:
                                    return new DisplayTimeRsp();
                                default:
                                    return null;
                            }
                    }
            }
        }
        return new DeviceNotifyRsp();
    }
}


## 2. QCDataParser.java

package com.oudmon.ble.base.bluetooth;

import android.util.SparseArray;
import com.elvishew.xlog.XLog;
import com.oudmon.ble.base.communication.Constants;
import com.oudmon.ble.base.communication.ICommandResponse;
import com.oudmon.ble.base.communication.rsp.BaseRspCmd;
import com.oudmon.ble.base.request.LocalWriteRequest;
import com.oudmon.qc_utils.bytes.DataTransferUtils;
import java.util.Arrays;

/* loaded from: classes4.dex */
public class QCDataParser {

    /* renamed from: a, reason: collision with root package name */
    public static SparseArray f26149a = new SparseArray();

    public static boolean checkCrc(byte[] bArr) {
        int i2 = 0;
        for (int i3 = 0; i3 < bArr.length - 1; i3++) {
            i2 += bArr[i3];
        }
        return bArr[bArr.length - 1] == ((byte) (i2 & 255));
    }

    public static boolean parserAndDispatchNotifyData(SparseArray<ICommandResponse> sparseArray, byte[] bArr) {
        int i2 = bArr[0] & (~Constants.f26289m);
        ICommandResponse iCommandResponse = sparseArray.get(i2);
        XLog.i("notifyKey: " + DataTransferUtils.getHexString(DataTransferUtils.intToBytes(i2)));
        if (iCommandResponse != null) {
            BaseRspCmd baseRspCmdCreateBean = (BaseRspCmd) f26149a.get(i2);
            if (baseRspCmdCreateBean == null) {
                baseRspCmdCreateBean = BeanFactory.createBean(i2, 0);
            }
            if (baseRspCmdCreateBean != null) {
                if (baseRspCmdCreateBean.acceptData(Arrays.copyOfRange(bArr, 1, bArr.length - 1))) {
                    f26149a.put(i2, baseRspCmdCreateBean);
                    return true;
                }
                iCommandResponse.onDataResponse(baseRspCmdCreateBean);
                f26149a.delete(i2);
                return true;
            }
        }
        return false;
    }

    public static boolean parserAndDispatchReqData(byte[] bArr) {
        ICommandResponse iCommandResponse;
        int i2 = bArr[0] & (~Constants.f26289m);
        LocalWriteRequest localWriteRequest = BleOperateManager.getInstance().getLocalWriteRequestConcurrentHashMap().get(Integer.valueOf(i2));
        if (localWriteRequest != null && (iCommandResponse = localWriteRequest.getiOpResponse()) != null) {
            BaseRspCmd baseRspCmdCreateBean = (BaseRspCmd) f26149a.get(i2);
            if (baseRspCmdCreateBean == null) {
                try {
                    baseRspCmdCreateBean = BeanFactory.createBean(i2, localWriteRequest.getType());
                } catch (Exception e2) {
                    e2.printStackTrace();
                    BleOperateManager.getInstance().getLocalWriteRequestConcurrentHashMap().clear();
                }
            }
            if (baseRspCmdCreateBean != null) {
                baseRspCmdCreateBean.setCmdType(i2);
                if (baseRspCmdCreateBean.acceptData(Arrays.copyOfRange(bArr, 1, bArr.length - 1))) {
                    f26149a.put(i2, baseRspCmdCreateBean);
                    return true;
                }
                iCommandResponse.onDataResponse(baseRspCmdCreateBean);
                f26149a.delete(i2);
                return true;
            }
        }
        return false;
    }
}


## 3. BaseRspCmd.java (Base Class)

package com.oudmon.ble.base.communication.rsp;

/* loaded from: classes4.dex */
public abstract class BaseRspCmd {

    /* renamed from: a, reason: collision with root package name */
    public int f26633a;

    /* renamed from: b, reason: collision with root package name */
    public int f26634b;

    public abstract boolean acceptData(byte[] bArr);

    public int getCmdType() {
        return this.f26634b;
    }

    public int getStatus() {
        return this.f26633a;
    }

    public void setCmdType(int i2) {
        this.f26634b = i2;
    }

    public void setStatus(int i2) {
        this.f26633a = i2;
    }
}


## 4. ReadHeartRateRsp.java (History Type - Multi-packet Collection)

package com.oudmon.ble.base.communication.rsp;

import android.util.Log;
import com.oudmon.qc_utils.bytes.DataTransferUtils;
import com.oudmon.qc_utils.date.DateUtil;
import java.util.TimeZone;

/* loaded from: classes4.dex */
public class ReadHeartRateRsp extends BaseRspCmd {

    /* renamed from: e, reason: collision with root package name */
    public int f26787e;

    /* renamed from: f, reason: collision with root package name */
    public byte[] f26788f;

    /* renamed from: c, reason: collision with root package name */
    public int f26785c = 0;

    /* renamed from: d, reason: collision with root package name */
    public int f26786d = 0;

    /* renamed from: g, reason: collision with root package name */
    public boolean f26789g = false;

    /* renamed from: h, reason: collision with root package name */
    public int f26790h = 5;

    public static float getTimeZone() {
        return TimeZone.getDefault().getOffset(System.currentTimeMillis()) / 3600000.0f;
    }

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        try {
            byte b2 = bArr[0];
            int i2 = b2 & 255;
            if (i2 != 255 && (!new DateUtil(getmUtcTime(), true).isToday() || b2 != 23)) {
                if (i2 == 0) {
                    this.f26789g = false;
                    int i3 = bArr[1];
                    this.f26785c = i3;
                    this.f26790h = bArr[2];
                    this.f26788f = new byte[i3 * 13];
                    Log.i("Jxr35", "0x00.. size: " + this.f26785c);
                } else if (i2 == 1) {
                    this.f26787e = DataTransferUtils.bytesToInt(new byte[]{bArr[1], bArr[2], bArr[3], bArr[4]}, 0);
                    this.f26787e -= (int) (getTimeZone() * 3600.0f);
                    System.arraycopy(bArr, 5, this.f26788f, 0, bArr.length - 5);
                    this.f26786d += bArr.length - 5;
                } else if (getCmdType() == 21) {
                    System.arraycopy(bArr, 1, this.f26788f, this.f26786d, bArr.length - 1);
                    this.f26786d += 13;
                    if (b2 == this.f26785c - 1) {
                        this.f26789g = true;
                        return false;
                    }
                }
                return true;
            }
            this.f26789g = true;
            return false;
        } catch (Exception e2) {
            e2.printStackTrace();
            this.f26788f = new byte[this.f26785c * 13];
            Log.i("Jxr35", "0x00.. size: " + this.f26785c);
            return false;
        }
    }

    public int getRange() {
        return this.f26790h;
    }

    public byte[] getmHeartRateArray() {
        byte[] bArr = this.f26788f;
        if (bArr != null) {
            byte[] bArr2 = new byte[288];
            if (bArr.length > 288) {
                System.arraycopy(bArr, 0, bArr2, 0, 288);
                return bArr2;
            }
            if (bArr.length < 288) {
                System.arraycopy(bArr, 0, bArr2, 0, bArr.length);
                return bArr2;
            }
            DateUtil dateUtil = new DateUtil(this.f26787e, true);
            if (dateUtil.isToday()) {
                int todayMin = dateUtil.getTodayMin() / 5;
                int i2 = 0;
                while (true) {
                    byte[] bArr3 = this.f26788f;
                    if (i2 >= bArr3.length) {
                        break;
                    }
                    if (i2 > todayMin) {
                        bArr3[i2] = 0;
                    }
                    i2++;
                }
            }
        }
        byte[] bArr4 = this.f26788f;
        return bArr4 == null ? new byte[0] : bArr4;
    }

    public int getmUtcTime() {
        return this.f26787e;
    }

    public boolean isEndFlag() {
        return this.f26789g;
    }
}


## 5. ReadSleepDetailsRsp.java (History Type - Multi-packet Collection)

package com.oudmon.ble.base.communication.rsp;

import android.util.Log;
import com.oudmon.ble.base.communication.entity.BleSleepDetails;
import com.oudmon.ble.base.communication.utils.BLEDataFormatUtils;
import java.util.ArrayList;

/* loaded from: classes4.dex */
public class ReadSleepDetailsRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public ArrayList f26806c = new ArrayList();

    /* renamed from: d, reason: collision with root package name */
    public int f26807d = 0;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        byte b2 = bArr[0];
        int i2 = this.f26807d;
        if (i2 == 0 && (b2 & 255) == 255) {
            this.f26806c.clear();
            return false;
        }
        if (i2 == 0 && (b2 & 255) == 240) {
            Log.i("Jxr35", "acceptData: init data list");
            this.f26806c.clear();
            this.f26807d++;
        } else {
            BleSleepDetails bleSleepDetails = new BleSleepDetails();
            bleSleepDetails.setYear(BLEDataFormatUtils.BCDToDecimal(bArr[0]) + 2000);
            bleSleepDetails.setMonth(BLEDataFormatUtils.BCDToDecimal(bArr[1]));
            bleSleepDetails.setDay(BLEDataFormatUtils.BCDToDecimal(bArr[2]));
            bleSleepDetails.setTimeIndex(bArr[3]);
            int[] iArr = new int[8];
            for (int i3 = 1; i3 < 8; i3++) {
                iArr[i3] = bArr[i3 + 5] & 255;
            }
            bleSleepDetails.setSleepQualities(iArr);
            this.f26806c.add(bleSleepDetails);
            this.f26807d++;
            if (bArr[4] == bArr[5] - 1) {
                return false;
            }
        }
        return true;
    }

    public ArrayList<BleSleepDetails> getBleSleepDetailses() {
        return this.f26806c;
    }

    public String toString() {
        return "ReadSleepDetailsRsp{status=" + this.f26633a + ", bleSleepDetailses=" + this.f26806c + ", index=" + this.f26807d + '}';
    }
}


## 6. ReadBlePressureRsp.java (History Type - Multi-packet Collection)

package com.oudmon.ble.base.communication.rsp;

import android.util.Log;
import com.oudmon.ble.base.communication.entity.BlePressure;
import com.oudmon.ble.base.communication.utils.DataParseUtils;
import com.oudmon.qc_utils.bytes.DataTransferUtils;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.List;
import java.util.TimeZone;

/* loaded from: classes4.dex */
public class ReadBlePressureRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public int f26779c = 0;

    /* renamed from: d, reason: collision with root package name */
    public List f26780d = new ArrayList();

    /* renamed from: e, reason: collision with root package name */
    public Calendar f26781e = Calendar.getInstance();

    public static float getTimeZone() {
        return TimeZone.getDefault().getOffset(System.currentTimeMillis()) / 3600000.0f;
    }

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        Log.i("Jxr35", "ReadBlePressureRsp -> acceptData -> data: " + DataTransferUtils.getHexString(bArr));
        byte[] bArrCopyOfRange = Arrays.copyOfRange(bArr, 0, 4);
        if ("ffffffff".equalsIgnoreCase(DataTransferUtils.getHexString(bArrCopyOfRange))) {
            this.f26779c = 0;
            return false;
        }
        this.f26779c++;
        long jByteArrayToInt = DataParseUtils.byteArrayToInt(bArrCopyOfRange);
        int timeZone = (int) (getTimeZone() * 3600.0f);
        long j2 = jByteArrayToInt - timeZone;
        Log.i("Jxr35", "timeStamp: " + j2 + ", timeOffset: " + timeZone);
        this.f26780d.add(new BlePressure(j2, bArr[5] & 255, bArr[4] & 255));
        if (this.f26779c < 50) {
            return true;
        }
        this.f26779c = 0;
        return false;
    }

    public List<BlePressure> getValueList() {
        return this.f26780d;
    }
}


## 7. ReadDetailSportDataRsp.java (History Type - Multi-packet Collection)

package com.oudmon.ble.base.communication.rsp;

import com.oudmon.ble.base.communication.entity.BleStepDetails;
import com.oudmon.ble.base.communication.utils.BLEDataFormatUtils;
import java.util.ArrayList;

/* loaded from: classes4.dex */
public class ReadDetailSportDataRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public ArrayList f26782c = new ArrayList();

    /* renamed from: d, reason: collision with root package name */
    public int f26783d = 0;

    /* renamed from: e, reason: collision with root package name */
    public boolean f26784e = false;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        byte b2 = bArr[0];
        int i2 = this.f26783d;
        if (i2 == 0 && (b2 & 255) == 255) {
            this.f26782c.clear();
            return false;
        }
        if (i2 == 0 && (b2 & 255) == 240) {
            if (bArr[2] == 1) {
                this.f26784e = true;
            }
            this.f26783d = i2 + 1;
            this.f26782c.clear();
        } else {
            BleStepDetails bleStepDetails = new BleStepDetails();
            bleStepDetails.setYear(BLEDataFormatUtils.BCDToDecimal(bArr[0]) + 2000);
            bleStepDetails.setMonth(BLEDataFormatUtils.BCDToDecimal(bArr[1]));
            bleStepDetails.setDay(BLEDataFormatUtils.BCDToDecimal(bArr[2]));
            bleStepDetails.setTimeIndex(bArr[3]);
            int iBytes2Int = BLEDataFormatUtils.bytes2Int(new byte[]{bArr[7], bArr[6]});
            if (this.f26784e) {
                iBytes2Int *= 10;
            }
            bleStepDetails.setCalorie(iBytes2Int);
            bleStepDetails.setWalkSteps(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[9], bArr[8]}));
            bleStepDetails.setDistance(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[11], bArr[10]}));
            this.f26782c.add(bleStepDetails);
            this.f26783d++;
            if (bArr[4] == bArr[5] - 1) {
                return false;
            }
        }
        return true;
    }

    public ArrayList<BleStepDetails> getBleStepDetailses() {
        return this.f26782c;
    }
}


## 8. TotalSportDataRsp.java (Aggregated Collection - 2-packet)

package com.oudmon.ble.base.communication.rsp;

import android.util.Log;
import com.oudmon.ble.base.communication.entity.BleStepTotal;
import com.oudmon.ble.base.communication.utils.BLEDataFormatUtils;

/* loaded from: classes4.dex */
public class TotalSportDataRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public int f26876c = 2;

    /* renamed from: d, reason: collision with root package name */
    public int f26877d = 0;

    /* renamed from: e, reason: collision with root package name */
    public BleStepTotal f26878e;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        byte b2 = bArr[0];
        int i2 = this.f26877d;
        if (b2 != i2 || b2 >= this.f26876c) {
            Log.e("Jxr35", "acceptData: index 错误 need=" + this.f26877d + " received=" + ((int) b2));
            this.f26878e = null;
            return false;
        }
        if (bArr[2] == 0 && bArr[3] == 0 && bArr[4] == 0) {
            Log.d("Jxr35", "没有存储数据");
            this.f26878e = null;
            return false;
        }
        if (i2 == 0) {
            BleStepTotal bleStepTotal = new BleStepTotal();
            this.f26878e = bleStepTotal;
            bleStepTotal.setDaysAgo(BLEDataFormatUtils.BCDToDecimal(bArr[1]));
            this.f26878e.setYear(BLEDataFormatUtils.BCDToDecimal(bArr[2]) + 2000);
            this.f26878e.setMonth(BLEDataFormatUtils.BCDToDecimal(bArr[3]));
            this.f26878e.setDay(BLEDataFormatUtils.BCDToDecimal(bArr[4]));
            this.f26878e.setTotalSteps(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[5], bArr[6], bArr[7]}));
            this.f26878e.setRunningSteps(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[8], bArr[9], bArr[10]}));
            this.f26878e.setCalorie(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[11], bArr[12], bArr[13]}));
        } else if (i2 == 1) {
            int iBCDToDecimal = BLEDataFormatUtils.BCDToDecimal(bArr[1]);
            int iBCDToDecimal2 = BLEDataFormatUtils.BCDToDecimal(bArr[2]) + 2000;
            int iBCDToDecimal3 = BLEDataFormatUtils.BCDToDecimal(bArr[3]);
            int iBCDToDecimal4 = BLEDataFormatUtils.BCDToDecimal(bArr[4]);
            BleStepTotal bleStepTotal2 = this.f26878e;
            if (bleStepTotal2 != null && bleStepTotal2.getDaysAgo() == iBCDToDecimal && this.f26878e.getYear() == iBCDToDecimal2 && this.f26878e.getMonth() == iBCDToDecimal3 && this.f26878e.getDay() == iBCDToDecimal4) {
                this.f26878e.setWalkDistance(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[5], bArr[6], bArr[7]}));
                this.f26878e.setSportDuration(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[8], bArr[9]}) * 60);
                this.f26878e.setSleepDuration(BLEDataFormatUtils.bytes2Int(new byte[]{bArr[10], bArr[11]}) * 60);
            }
        }
        int i3 = this.f26877d + 1;
        this.f26877d = i3;
        return i3 != this.f26876c;
    }

    public BleStepTotal getBleStepTotal() {
        return this.f26878e;
    }
}


## 9. RealTimeHeartRateRsp.java (Live Notify Type - Single Packet)

package com.oudmon.ble.base.communication.rsp;

/* loaded from: classes4.dex */
public class RealTimeHeartRateRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public int f26813c;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        this.f26813c = bArr[0];
        return false;
    }

    public int getHeart() {
        return this.f26813c;
    }
}


## 10. DeviceNotifyRsp.java (Catch-All Notify - Single Packet)

package com.oudmon.ble.base.communication.rsp;

/* loaded from: classes4.dex */
public class DeviceNotifyRsp extends BaseRspCmd {

    /* renamed from: c, reason: collision with root package name */
    public int f26656c;

    /* renamed from: d, reason: collision with root package name */
    public byte[] f26657d;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        this.f26656c = bArr[0];
        this.f26657d = bArr;
        return false;
    }

    public int getDataType() {
        return this.f26656c;
    }

    public byte[] getLoadData() {
        return this.f26657d;
    }
}


---

SUMMARY:

The "all collected information" classes are:
- ReadHeartRateRsp - accumulates multiple packets into f26788f byte array
- ReadSleepDetailsRsp - accumulates into ArrayList f26806c
- ReadBlePressureRsp - accumulates into List f26780d (50 records per batch)
- ReadDetailSportDataRsp - accumulates into ArrayList f26782c
- TotalSportDataRsp - aggregates 2 packets into single BleStepTotal object

These classes represent "all collected information" - they accumulate data across multiple packets until acceptData() returns false.


## 11. DeviceSupportFunctionRsp.java (Capability Discovery Response)

package com.oudmon.ble.base.communication.rsp;

/* loaded from: classes4.dex */
public class DeviceSupportFunctionRsp extends BaseRspCmd {
    public boolean A;
    public boolean B;
    public boolean F;
    public boolean G;
    public boolean H;
    public boolean I;
    public boolean J;
    public boolean M;

    /* renamed from: c, reason: collision with root package name */
    public boolean f26658c;

    /* renamed from: d, reason: collision with root package name */
    public boolean f26659d;

    /* renamed from: e, reason: collision with root package name */
    public boolean f26660e;

    /* renamed from: f, reason: collision with root package name */
    public boolean f26661f;

    /* renamed from: g, reason: collision with root package name */
    public boolean f26662g;

    /* renamed from: h, reason: collision with root package name */
    public boolean f26663h;

    /* renamed from: i, reason: collision with root package name */
    public boolean f26664i;

    /* renamed from: j, reason: collision with root package name */
    public boolean f26665j;

    /* renamed from: k, reason: collision with root package name */
    public boolean f26666k;

    /* renamed from: l, reason: collision with root package name */
    public boolean f26667l;

    /* renamed from: m, reason: collision with root package name */
    public boolean f26668m;

    /* renamed from: n, reason: collision with root package name */
    public boolean f26669n;

    /* renamed from: o, reason: collision with root package name */
    public boolean f26670o;

    /* renamed from: p, reason: collision with root package name */
    public boolean f26671p;

    /* renamed from: q, reason: collision with root package name */
    public boolean f26672q;

    /* renamed from: r, reason: collision with root package name */
    public boolean f26673r;

    /* renamed from: s, reason: collision with root package name */
    public boolean f26674s;

    /* renamed from: t, reason: collision with root package name */
    public boolean f26675t;

    /* renamed from: u, reason: collision with root package name */
    public boolean f26676u;

    /* renamed from: v, reason: collision with root package name */
    public boolean f26677v;

    /* renamed from: w, reason: collision with root package name */
    public boolean f26678w;

    /* renamed from: x, reason: collision with root package name */
    public boolean f26679x;

    /* renamed from: y, reason: collision with root package name */
    public boolean f26680y;

    /* renamed from: z, reason: collision with root package name */
    public boolean f26681z;
    public boolean C = false;
    public boolean D = false;
    public boolean E = false;
    public boolean K = false;
    public boolean L = false;
    public boolean N = false;
    public boolean O = false;
    public boolean P = false;
    public boolean Q = false;
    public boolean R = false;
    public boolean S = false;
    public boolean T = false;
    public boolean U = false;

    @Override // com.oudmon.ble.base.communication.rsp.BaseRspCmd
    public boolean acceptData(byte[] bArr) {
        byte b2 = bArr[1];
        this.f26658c = (b2 & 1) != 0;
        this.f26659d = (b2 & 2) != 0;
        this.f26660e = (b2 & 4) != 0;
        this.f26661f = (b2 & 8) != 0;
        this.H = (b2 & 64) != 0;
        this.f26662g = (b2 & 128) != 0;
        byte b3 = bArr[2];
        this.f26663h = (b3 & 1) != 0;
        this.f26664i = (b3 & 2) != 0;
        this.f26665j = (b3 & 4) != 0;
        this.f26666k = (b3 & 8) != 0;
        this.f26667l = (b3 & 16) != 0;
        this.f26668m = (b3 & 32) != 0;
        this.f26669n = (b3 & 64) != 0;
        byte b4 = bArr[3];
        this.f26680y = (b4 & 1) != 0;
        this.f26678w = (b4 & 4) != 0;
        this.f26679x = (b4 & 8) != 0;
        this.f26681z = (b4 & 16) != 0;
        this.A = (b4 & 32) != 0;
        this.I = (b4 & 128) != 0;
        byte b5 = bArr[4];
        this.B = (b5 & 8) != 0;
        this.D = (b5 & 16) != 0;
        this.E = (b5 & 32) != 0;
        this.F = (b5 & 128) != 0;
        byte b6 = bArr[5];
        this.C = b6 != 0;
        if (b6 != 0) {
            this.f26659d = (b6 & 128) != 0;
            this.f26670o = (b6 & 1) != 0;
            this.f26671p = (b6 & 2) != 0;
            this.f26672q = (b6 & 4) != 0;
            this.f26673r = (b6 & 8) != 0;
            this.f26674s = (b6 & 16) != 0;
            this.f26675t = (b6 & 32) != 0;
            this.f26676u = (b6 & 64) != 0;
            this.f26677v = (b6 & 128) != 0;
        }
        byte b7 = bArr[6];
        if (b7 != 0) {
            this.M = (b7 & 8) != 0;
            this.G = (b7 & 16) != 0;
            this.J = (b7 & 32) != 0;
            this.K = (b7 & 64) != 0;
            this.L = (b7 & 128) != 0;
        }
        byte b8 = bArr[7];
        if (b8 != 0) {
            this.O = (b8 & 1) != 0;
            this.P = (b8 & 2) != 0;
            this.Q = (b8 & 4) != 0;
            this.R = (b8 & 8) != 0;
            this.S = (b8 & 16) != 0;
            this.N = (b8 & 32) != 0;
            this.T = (b8 & 64) != 0;
        }
        byte b9 = bArr[9];
        if (b9 != 0) {
            this.U = (b9 & 2) != 0;
        }
        return false;
    }
}


## 12. BloodOxygenSettingReq.java (SpO₂ Request)

package com.oudmon.ble.base.communication.req;

/* loaded from: classes4.dex */
public class BloodOxygenSettingReq extends MixtureReq {
    private BloodOxygenSettingReq() {
        super((byte) 44);
        this.f26558b = new byte[]{1};
    }

    public static BloodOxygenSettingReq getReadInstance() {
        return new BloodOxygenSettingReq();
    }

    public static BloodOxygenSettingReq getWriteInstance(boolean z2) {
        return new BloodOxygenSettingReq(z2);
    }

    public static BloodOxygenSettingReq getWriteInstance(boolean z2, byte b2) {
        return new BloodOxygenSettingReq(z2, b2);
    }

    private BloodOxygenSettingReq(boolean z2) {
        super((byte) 44);
        this.f26558b = new byte[]{2, z2 ? (byte) 1 : (byte) 0};
    }

    private BloodOxygenSettingReq(boolean z2, byte b2) {
        super((byte) 44);
        this.f26558b = new byte[]{2, z2 ? (byte) 1 : (byte) 0, b2};
    }
}

**Opcode**: 0x2C (44)
**Payload Format**:
- Read: {0x01}
- Write (enable only): {0x02, enable_flag}
- Write (enable + interval): {0x02, enable_flag, interval_byte}


## 13. HRVReq.java (HRV Data Request)

package com.oudmon.ble.base.communication.req;

/* loaded from: classes4.dex */
public class HRVReq extends MixtureReq {
    public HRVReq(byte b2) {
        super((byte) 57);
        this.f26558b = new byte[]{b2};
    }
}

**Opcode**: 0x39 (57)
**Payload Format**: {command_byte}


## 14. HrvSettingReq.java (HRV Setting Request)

package com.oudmon.ble.base.communication.req;

/* loaded from: classes4.dex */
public class HrvSettingReq extends MixtureReq {
    private HrvSettingReq() {
        super((byte) 56);
        this.f26558b = new byte[]{1};
    }

    public static HrvSettingReq getReadInstance() {
        return new HrvSettingReq();
    }

    public HrvSettingReq(boolean z2) {
        super((byte) 56);
        this.f26558b = new byte[]{2, z2 ? (byte) 1 : (byte) 0};
    }
}

**Opcode**: 0x38 (56)
**Payload Format**:
- Read: {0x01}
- Write: {0x02, enable_flag}


## 15. DeviceNotifyRsp Usage Sites

### 15.1 DeviceNotifyListener.java (Base Listener Class)

package com.oudmon.ble.base.communication.responseImpl;

import com.oudmon.ble.base.communication.ICommandResponse;
import com.oudmon.ble.base.communication.rsp.DeviceNotifyRsp;
import java.util.Iterator;
import java.util.concurrent.ConcurrentHashMap;

/* loaded from: classes4.dex */
public class DeviceNotifyListener implements ICommandResponse<DeviceNotifyRsp> {

    /* renamed from: a, reason: collision with root package name */
    public ConcurrentHashMap f26621a = new ConcurrentHashMap();

    public void removeCallback(int i2) {
        this.f26621a.remove(Integer.valueOf(i2));
    }

    public void removeOtherCallbacks() {
        this.f26621a.remove(1);
        this.f26621a.remove(2);
        this.f26621a.remove(3);
        this.f26621a.remove(5);
        this.f26621a.remove(7);
        this.f26621a.remove(9);
    }

    public void setOutRspIOdmOpResponse(int i2, ICommandResponse<DeviceNotifyRsp> iCommandResponse) {
        this.f26621a.put(Integer.valueOf(i2), iCommandResponse);
        if (this.f26621a.get(100) != null) {
            removeOtherCallbacks();
        }
    }

    @Override // com.oudmon.ble.base.communication.ICommandResponse
    public void onDataResponse(DeviceNotifyRsp deviceNotifyRsp) {
        Iterator it = this.f26621a.values().iterator();
        while (it.hasNext()) {
            ((ICommandResponse) it.next()).onDataResponse(deviceNotifyRsp);
        }
    }
}

### 15.2 Registration Sites (addOutDeviceListener calls)

**Registration Pattern**: `BleOperateManager.getInstance().addOutDeviceListener(dataType, listener)`

**Usage Sites**:

1. **DayStepFragment.java** (Line 1006)
   - Data Type: 11
   - Listener: MyDeviceNotifyListener
   - Purpose: Step data notifications

2. **HeartActivity.java** (Line 1520)
   - Data Type: 1
   - Listener: MyDeviceNotifyListener
   - Purpose: Heart rate data notifications
   - Handler: Checks `resultEntity.getDataType() == 1` to sync today's data

3. **TemperatureBodyActivity.java** (Line 1307)
   - Data Type: 5
   - Listener: MyDeviceNotifyListener
   - Purpose: Body temperature notifications

4. **BloodPressureActivity.java** (Line 1199)
   - Data Type: 2
   - Listener: MyDeviceNotifyListener
   - Purpose: Blood pressure notifications

5. **RingDayStepFragment.java** (Line 1882)
   - Data Type: 11
   - Listener: MyDeviceNotifyListener
   - Purpose: Step data notifications (ring variant)

6. **BloodOxygenActivity.java** (Line 1190)
   - Data Type: 3
   - Listener: MyDeviceNotifyListener
   - Purpose: Blood oxygen (SpO₂) notifications
   - Handler: Checks `resultEntity.getDataType() == 3` to sync today's data

7. **TemperatureActivity.java** (Line 1130)
   - Data Type: 5
   - Listener: MyDeviceNotifyListener
   - Purpose: Temperature notifications

8. **DaySportFragment.java** (Line 511)
   - Data Type: 7
   - Listener: MyDeviceNotifyListener
   - Purpose: Sport data notifications

9. **RevisionActivity.java** (Line 356)
   - Data Type: 12
   - Listener: MyChangingDeviceNotifyListener
   - Purpose: Device revision/touch control notifications

10. **HealthyFragment.java** (Line 7075)
    - Data Type: 100
    - Listener: MyDeviceNotifyListener
    - Purpose: General health data notifications (master listener)

### 15.3 Data Type Mapping

Based on usage sites, DeviceNotifyRsp.getDataType() values:
- 1 = Heart Rate
- 2 = Blood Pressure
- 3 = Blood Oxygen (SpO₂)
- 5 = Temperature
- 7 = Sport Data
- 11 = Step Data
- 12 = Device Revision/Touch Control
- 100 = General Health Data (master)

### 15.4 Handler Pattern

Typical handler implementation:
```java
public void onDataResponse(@Nullable DeviceNotifyRsp resultEntity) {
    if (resultEntity != null && resultEntity.getStatus() == 0) {
        if (resultEntity.getDataType() == EXPECTED_TYPE) {
            // Process notification
            viewModel.syncTodayData();
        }
    }
}
```

### 15.5 Registration Flow

1. Create listener: `MyDeviceNotifyListener listener = new MyDeviceNotifyListener()`
2. Register: `BleOperateManager.getInstance().addOutDeviceListener(dataType, listener)`
3. This registers listener for opcode 115 (0x73) - DeviceNotifyRsp
4. When DeviceNotifyRsp arrives, DeviceNotifyListener routes to registered callbacks by dataType
5. Each activity checks `getDataType()` to filter relevant notifications


## 16. COMPREHENSIVE PROTOCOL DETAILS

### 16.1 DeviceSupportFunctionRsp Feature Bit Mapping

**Source**: `DeviceCmdInit.java:219` - Maps DeviceSupportFunctionRsp to DeviceFunctionSupport

**Mapping Table** (DeviceSupportFunctionRsp field → DeviceFunctionSupport field):

| DeviceSupportFunctionRsp Field | Bit Position | DeviceFunctionSupport Field | Meaning |
|-------------------------------|--------------|----------------------------|---------|
| f26658c | Byte 1, bit 0 | supportTouch | Touch control support |
| f26659d | Byte 1, bit 1 | supportMoslin | Muslim features support |
| f26660e | Byte 1, bit 2 | supportAPPRevision | App revision query support |
| f26661f | Byte 1, bit 3 | supportBlePair | BLE pairing support |
| H | Byte 1, bit 6 | (unknown) | Reserved |
| f26662g | Byte 1, bit 7 | (unknown) | Reserved |
| f26663h | Byte 2, bit 0 | supportGesture | Gesture control support |
| f26664i | Byte 2, bit 1 | supportRingMusic | Ring music support |
| f26665j | Byte 2, bit 2 | supportRingVideo | Ring video support |
| f26666k | Byte 2, bit 3 | supportRingEbook | Ring ebook support |
| f26667l | Byte 2, bit 4 | supportCamera | Camera control support |
| f26668m | Byte 2, bit 5 | supportRingCall | Ring call support |
| f26669n | Byte 2, bit 6 | supportRingGame | Ring game support |
| f26680y | Byte 3, bit 0 | supportHeartMeasure | Heart rate measurement support |
| f26678w | Byte 3, bit 2 | supportLongSit | Long sit reminder support |
| f26679x | Byte 3, bit 3 | supportDrink | Drink reminder support |
| f26681z | Byte 3, bit 4 | supportSkinTemperature | Skin temperature support |
| A | Byte 3, bit 5 | supportNoSingleTemperature | No single temperature support |
| I | Byte 3, bit 7 | supportAiAnalyze | AI health analysis support |
| B | Byte 4, bit 3 | (unknown) | Reserved |
| D | Byte 4, bit 4 | TP Sleep | Touch panel sleep support |
| E | Byte 4, bit 5 | (unknown) | Reserved |
| F | Byte 4, bit 7 | (unknown) | Reserved |
| C | Byte 5, all bits | RingTouchOnly | Ring touch-only mode flag |
| f26670o | Byte 5, bit 0 (if C=true) | supportGesture | Gesture (alternate mapping) |
| f26671p | Byte 5, bit 1 (if C=true) | supportRingMusic | Ring music (alternate) |
| f26672q | Byte 5, bit 2 (if C=true) | supportRingVideo | Ring video (alternate) |
| f26673r | Byte 5, bit 3 (if C=true) | supportRingEbook | Ring ebook (alternate) |
| f26674s | Byte 5, bit 4 (if C=true) | supportCamera | Camera (alternate) |
| f26675t | Byte 5, bit 5 (if C=true) | supportRingCall | Ring call (alternate) |
| f26676u | Byte 5, bit 6 (if C=true) | supportRingGame | Ring game (alternate) |
| f26677v | Byte 5, bit 7 (if C=true) | supportMoslin | Muslim features (alternate) |
| M | Byte 6, bit 3 | supportLoverSpace | Lover space feature |
| G | Byte 6, bit 4 | (unknown) | Reserved |
| J | Byte 6, bit 5 | (unknown) | Reserved |
| K | Byte 6, bit 6 | supportAlarm | Alarm support |
| L | Byte 6, bit 7 | (unknown) | Reserved |
| O | Byte 7, bit 0 | (unknown) | Reserved |
| P | Byte 7, bit 1 | supportNotification | Notification support |
| Q | Byte 7, bit 2 | (unknown) | Reserved |
| R | Byte 7, bit 3 | supportCallReminder | Call reminder support |
| S | Byte 7, bit 4 | supportRealTimeHr | Real-time heart rate support |
| N | Byte 7, bit 5 | supportFriends | Friends feature support |
| T | Byte 7, bit 6 | supportRealTimeHrRemind | Real-time HR reminder support |
| U | Byte 9, bit 1 | supportLoverInteract | Lover interaction support |

**Note**: Byte 0 is not parsed (likely reserved or status). Byte 8 is skipped (not used).

**Conditional Mapping**: If `C` (RingTouchOnly) is true, byte 5 fields override byte 2 fields for ring-specific features.


### 16.2 Complete Opcode Catalogue (Beyond BeanFactory)

**Additional Request Classes Found** (not in BeanFactory snippet):

| Opcode | Hex | Class Name | Description |
|--------|-----|------------|-------------|
| 7 | 0x07 | ReadTotalSportDataReq | Read total sport data (days ago) |
| 8 | 0x08 | (unknown) | - |
| 9 | 0x09 | (unknown) | - |
| 11 | 0x0B | (unknown) | - |
| 14 | 0x0E | (unknown) | - |
| 15 | 0x0F | (unknown) | - |
| 16 | 0x10 | (unknown) | - |
| 18 | 0x12 | (unknown) | - |
| 23 | 0x17 | (unknown) | - |
| 24 | 0x18 | (unknown) | - |
| 27 | 0x1B | (unknown) | - |
| 28 | 0x1C | (unknown) | - |
| 32 | 0x20 | (unknown) | - |
| 36 | 0x24 | (unknown) | - |
| 41 | 0x29 | (unknown) | - |
| 42 | 0x2A | (unknown) | - |
| 43 | 0x2B | (unknown) | - |
| 45 | 0x2D | (unknown) | - |
| 46 | 0x2E | (unknown) | - |
| 48 | 0x30 | (unknown) | - |
| 49 | 0x31 | (unknown) | - |
| 51 | 0x33 | (unknown) | - |
| 52 | 0x34 | (unknown) | - |
| 53 | 0x35 | (unknown) | - |
| 61 | 0x3D | (unknown) | - |
| 62 | 0x3E | (unknown) | - |
| 63 | 0x3F | (unknown) | - |
| 64 | 0x40 | (unknown) | - |
| 65 | 0x41 | (unknown) | - |
| 66 | 0x42 | (unknown) | - |
| 69 | 0x45 | (unknown) | - |
| 70 | 0x46 | (unknown) | - |
| 71 | 0x47 | (unknown) | - |
| 73 | 0x49 | (unknown) | - |
| 74 | 0x4A | (unknown) | - |
| 75 | 0x4B | (unknown) | - |
| 76 | 0x4C | (unknown) | - |
| 77 | 0x4D | (unknown) | - |
| 78 | 0x4E | (unknown) | - |
| 79 | 0x4F | (unknown) | - |
| 81 | 0x51 | (unknown) | - |
| 83 | 0x53 | (unknown) | - |
| 84 | 0x54 | (unknown) | - |
| 85 | 0x55 | (unknown) | - |
| 86 | 0x56 | (unknown) | - |
| 87 | 0x57 | (unknown) | - |
| 88 | 0x58 | (unknown) | - |
| 89 | 0x59 | (unknown) | - |
| 90 | 0x5A | (unknown) | - |
| 91 | 0x5B | (unknown) | - |
| 92 | 0x5C | (unknown) | - |
| 93 | 0x5D | (unknown) | - |
| 94 | 0x5E | (unknown) | - |
| 95 | 0x5F | (unknown) | - |
| 96 | 0x60 | (unknown) | - |
| 98 | 0x62 | (unknown) | - |
| 99 | 0x63 | (unknown) | - |
| 100 | 0x64 | (unknown) | - |
| 101 | 0x65 | (unknown) | - |
| 102 | 0x66 | (unknown) | - |
| 103 | 0x67 | (unknown) | - |
| 104 | 0x68 | (unknown) | - |
| 106 | 0x6A | StopHeartRateReq | Stop heart rate/health measurements |
| 107 | 0x6B | (unknown) | - |
| 108 | 0x6C | (unknown) | - |
| 109 | 0x6D | (unknown) | - |
| 110 | 0x6E | (unknown) | - |
| 111 | 0x6F | (unknown) | - |
| 112 | 0x70 | (unknown) | - |
| 113 | 0x71 | (unknown) | - |
| 117 | 0x75 | (unknown) | - |
| 118 | 0x76 | (unknown) | - |
| 121 | 0x79 | (unknown) | - |
| 124 | 0x7C | (unknown) | - |
| 125 | 0x7D | (unknown) | - |
| 127 | 0x7F | (unknown) | - |

**Additional Response Classes Found**:

| Opcode | Hex | Class Name | Description |
|--------|-----|------------|-------------|
| 7 | 0x07 | TotalSportDataRsp | Total sport data response (2-packet) |
| 72 | 0x48 | TodaySportDataRsp | Today's sport data (single packet) |
| 106 | 0x6A | StopHeartRateRsp | Stop measurement response |

**MixtureReq/MixtureRsp Pattern**:
- Many requests extend `MixtureReq` with action byte (1=read, 2=write, 3=response)
- Responses extend `MixtureRsp` with `readSubData()` method
- Action byte in payload[0]: 1=read response, 2=write response, 3=notification


### 16.3 DeviceNotifyRsp Payload Schemas Per DataType

**Base Structure**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | Data type identifier
1+     | N    | Payload    | bytes  | Type-specific data
```

**DataType 1 - Heart Rate**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 1 (Heart Rate)
1+     | N    | (unknown)  | bytes  | Heart rate notification data
```
- **Usage**: Triggers `syncTodayData()` when status == 0
- **Handler**: `HeartActivity.MyDeviceNotifyListener`

**DataType 2 - Blood Pressure**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 2 (Blood Pressure)
1+     | N    | (unknown)  | bytes  | BP notification data
```
- **Usage**: Triggers sync when status == 0
- **Handler**: `BloodPressureActivity.MyDeviceNotifyListener`

**DataType 3 - Blood Oxygen (SpO₂)**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 3 (Blood Oxygen)
1+     | N    | (unknown)  | bytes  | SpO₂ notification data
```
- **Usage**: Triggers `syncTodayData()` when status == 0
- **Handler**: `BloodOxygenActivity.MyDeviceNotifyListener`

**DataType 5 - Temperature**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 5 (Temperature)
1+     | N    | (unknown)  | bytes  | Temperature notification data
```
- **Usage**: Triggers sync when status == 0
- **Handler**: `TemperatureActivity.MyDeviceNotifyListener`, `TemperatureBodyActivity.MyDeviceNotifyListener`

**DataType 7 - Sport Data**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 7 (Sport Data)
1+     | N    | (unknown)  | bytes  | Sport notification data
```
- **Usage**: Triggers sync when status == 0
- **Handler**: `DaySportFragment.MyDeviceNotifyListener`

**DataType 11 - Step Data**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 11 (Step Data)
1+     | N    | (unknown)  | bytes  | Step notification data
```
- **Usage**: Used for step updates
- **Handler**: `DayStepFragment.MyDeviceNotifyListener`, `RingDayStepFragment.MyDeviceNotifyListener`

**DataType 12 - Device Revision/Touch Control**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 12 (Revision)
1      | 1    | (unknown)  | uint8  | Unknown
2      | 1    | Value      | uint8  | Touch/revision value (bytes2Int from byte[2])
```
- **Usage**: Device touch control/revision updates
- **Handler**: `RevisionActivity.MyChangingDeviceNotifyListener`
- **Parsing**: `BLEDataFormatUtils.bytes2Int(new byte[]{resultEntity.getLoadData()[2]})`

**DataType 18 - Step Data (Ring Variant)**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 18 (Step Data - Ring)
1-3    | 3    | TotalSteps | uint24 | Total steps (LE, bytes2Int)
4-6    | 3    | Calories   | uint24 | Calories (LE, bytes2Int)
7-9    | 3    | Distance   | uint24 | Distance (LE, bytes2Int)
```
- **Usage**: Ring-specific step data update
- **Handler**: `DayStepFragment.MyDeviceNotifyListener`, `RingDayStepFragment.MyDeviceNotifyListener`
- **Parsing**: 
  - Steps: `BLEDataFormatUtils.bytes2Int(new byte[]{data[1], data[2], data[3]})`
  - Calories: `BLEDataFormatUtils.bytes2Int(new byte[]{data[4], data[5], data[6]})`
  - Distance: `BLEDataFormatUtils.bytes2Int(new byte[]{data[7], data[8], data[9]})`

**DataType 100 - General Health Data**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DataType   | uint8  | 100 (General Health)
1+     | N    | Payload    | bytes  | General health notification
```
- **Usage**: Master listener for general health updates
- **Handler**: `HealthyFragment.MyDeviceNotifyListener`
- **Note**: When dataType 100 is registered, other listeners (1,2,3,5,7,9) are removed


### 16.4 SpO₂ Response Schema

**BloodOxygenSettingRsp** (Opcode 0x2C/44):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Action     | uint8  | 1=read response, 2=write response, 3=notification
1      | 1    | Enable     | uint8  | 1=enabled, 0=disabled
2      | 1    | Interval   | uint8  | Measurement interval (minutes)
```
- **Extends**: `MixtureRsp` (action byte in payload[0])
- **Methods**: `isEnable()`, `getInterval()`

**Note**: No dedicated SpO₂ history response found. SpO₂ data may use large data service or DeviceNotifyRsp.


### 16.5 HRV Response Schema

**HRVRsp** (Opcode 0x39/57) - Multi-packet Collection:

**Packet 0x00** (Header):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Marker     | uint8  | 0x00 (header marker)
1      | 1    | Count      | uint8  | Total record count
2      | 1    | Range      | uint8  | Time range (default: 30 = 30-minute intervals)
```

**Packet 0x01** (Date Offset + First Data):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Marker     | uint8  | 0x01 (date marker)
1      | 1    | DayOffset  | uint8  | Days ago (0=today, 1=yesterday, etc.)
2+     | N    | Data Start | bytes  | First data chunk
```

**Packets 0x02-0xFE** (Data Records):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Index      | uint8  | Packet index (0x02, 0x03, ..., count-1)
1-13   | 13   | Record     | bytes  | HRV record (13 bytes per record)
```

**Record Structure** (13 bytes per record):
- Same structure as heart rate: timestamp + HRV value + reserved
- **Sample Rate**: 30-minute intervals (default range)
- **End Condition**: `packetIndex == count - 1` OR `packetIndex == 0xFF` (no data)

**HRVSettingRsp** (Opcode 0x38/56):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Action     | uint8  | 1=read response, 2=write response
1      | 1    | Enable     | uint8  | 1=enabled, 0=disabled
```
- **Extends**: `MixtureRsp`
- **Method**: `isEnable()`


### 16.6 Pressure Response Schema

**PressureRsp** (Opcode 0x37/55) - Live Notification, Multi-packet:

**Packet Structure** (Same as HRVRsp):
- Packet 0x00: Header with count and range (default: 30 minutes)
- Packet 0x01: Day offset + first data
- Packets 0x02+: Data records (13 bytes each)
- **End Condition**: `packetIndex == count - 1` OR `0xFF` marker

**Record Structure**: 13 bytes (timestamp + pressure value + reserved)


### 16.7 History Read Request Payloads

**ReadHeartRateReq** (Opcode 0x15/21):
```
Payload: 4 bytes
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0-3    | 4    | Timestamp  | uint32 | UTC timestamp (seconds, Unix epoch)
```
- **Usage**: `new ReadHeartRateReq(unixTimestamp)`
- **Semantics**: Returns heart rate data from timestamp onwards (or whole day if timestamp is start of day)
- **Timezone**: Timestamp is UTC, adjusted by device timezone on response

**ReadSleepDetailsReq** (Opcode 0x44/68):
```
Payload: 4 bytes
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DayOffset  | uint8  | Days ago (0-29, 0=today)
1      | 1    | Reserved   | uint8  | Always 15 (0x0F)
2      | 1    | StartIndex | uint8  | Start segment index (0-95)
3      | 1    | EndIndex   | uint8  | End segment index (startIndex to 95)
```
- **Usage**: `new ReadSleepDetailsReq(dayOffset, startIndex, endIndex)`
- **Constraints**: 
  - `dayOffset <= 29`
  - `startIndex <= endIndex <= 95`
- **Semantics**: Returns sleep data for specified day and segment range
- **Segments**: 96 segments per day (15-minute intervals, 0-95)

**ReadPressureReq** (Opcode 0x14/20):
```
Payload: 6 bytes
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0-3    | 4    | Timestamp  | uint32 | UTC timestamp (seconds)
4      | 1    | Reserved   | uint8  | Always 0
5      | 1    | BatchSize  | uint8  | Records per batch (default: 50)
```
- **Usage**: `new ReadPressureReq(unixTimestamp)`
- **Semantics**: Returns BP data from timestamp, 50 records per batch
- **End Marker**: `0xFFFFFFFF` timestamp indicates no more data

**ReadBandSportReq** (Opcode 0x13/19):
```
Payload: 4 bytes
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0-3    | 4    | Timestamp  | uint32 | UTC timestamp (seconds)
```
- **Usage**: `new ReadBandSportReq(unixTimestamp)`
- **Semantics**: Returns sport data from timestamp onwards

**ReadTotalSportDataReq** (Opcode 0x07/7):
```
Payload: 1 byte
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | DaysAgo    | uint8  | Days ago (0=today, 1=yesterday, etc.)
```
- **Usage**: `new ReadTotalSportDataReq(daysAgo)`
- **Response**: `TotalSportDataRsp` (2-packet aggregated data)


### 16.8 History Retention and Sync Rules

**Data Retention**:
- **Reading does NOT clear data**: History reads are non-destructive
- **Device storage**: History data persists on device until overwritten by new data
- **Sync tracking**: App tracks `lastSyncTime` per data type to avoid re-downloading

**Sync Semantics**:
- **"Since Timestamp"**: `ReadHeartRateReq`, `ReadPressureReq`, `ReadBandSportReq` use timestamp parameter
  - Returns data from that timestamp onwards
  - If timestamp is start of day (00:00:00), returns whole day
  - Timestamp is UTC, device adjusts for timezone

- **"Whole Day"**: `ReadSleepDetailsReq` uses day offset (0-29 days ago)
  - Returns complete day's data for specified day
  - Segmented: Can request specific segment range (0-95) within day

- **"Days Ago"**: `ReadTotalSportDataReq` uses days ago (0=today)
  - Returns aggregated totals for that specific day

**Paging Rules**:
- **Heart Rate**: Multi-packet, packet index 0x00-0xFE, end when `index == count - 1`
- **Sleep**: Multi-packet, packet index in payload[4], end when `packetIndex == totalPackets - 1`
- **Blood Pressure**: Batched (50 records per batch), end when timestamp == 0xFFFFFFFF
- **Sport Data**: Multi-packet, packet index in payload[4], end when `packetIndex == totalPackets - 1`
- **HRV**: Multi-packet, same as heart rate (13-byte records)

**Sync Tracking**:
- App stores `lastSyncTime` per data type in database
- On sync: Queries data from `lastSyncTime` to current time
- After successful sync: Updates `lastSyncTime` to current time
- **No automatic clearing**: Device retains data until storage full


### 16.9 Multi-Packet Framing Rules (Definitive)

**Common Pattern** (Heart Rate, HRV, Pressure):
- **Packet 0x00**: Header packet
  - `payload[0] = 0x00`
  - `payload[1] = totalRecordCount`
  - `payload[2] = timeRange` (minutes per interval)
  
- **Packet 0x01**: Timestamp/Date packet
  - `payload[0] = 0x01`
  - `payload[1-4]` or `payload[1]` = timestamp/date info
  - `payload[5+]` = first data chunk
  
- **Packets 0x02-0xFE**: Data packets
  - `payload[0] = packetIndex` (0x02, 0x03, ..., count-1)
  - `payload[1+]` = record data (13 bytes per record)
  - **End Condition**: `packetIndex == totalRecordCount - 1`

**Sleep Pattern**:
- **Packet 0xF0**: Init packet
  - `payload[0] = 0xF0`
  - Clears data list
  
- **Data Packets**:
  - `payload[0-2]` = BCD date (year, month, day)
  - `payload[3]` = time index
  - `payload[4]` = current packet index
  - `payload[5]` = total packets - 1
  - `payload[6-13]` = sleep quality data (8 bytes)
  - **End Condition**: `packetIndex == totalPackets - 1`

**Sport Data Pattern**:
- **Packet 0xF0**: Init packet
  - `payload[0] = 0xF0`
  - `payload[2]` = calorie scale flag (1 = scale by 10)
  
- **Data Packets**:
  - `payload[0-2]` = BCD date
  - `payload[3]` = time index
  - `payload[4]` = current index
  - `payload[5]` = total - 1
  - `payload[6-11]` = calorie, steps, distance (little-endian)
  - **End Condition**: `packetIndex == totalPackets - 1`

**Blood Pressure Pattern**:
- **No header packet**: Direct data packets
- **Each Packet**: 6 bytes per record
  - `payload[0-3]` = timestamp (uint32, UTC)
  - `payload[4]` = SBP (systolic)
  - `payload[5]` = DBP (diastolic)
- **Batch Size**: 50 records per response (300 bytes total)
- **End Marker**: `timestamp == 0xFFFFFFFF` (no more data)

**Total Sport Data Pattern** (2-packet):
- **Packet 0**: 
  - `payload[0] = 0`
  - `payload[1]` = days ago (BCD)
  - `payload[2-4]` = date (BCD year, month, day)
  - `payload[5-13]` = totals (steps, running steps, calories)
  
- **Packet 1**:
  - `payload[0] = 1`
  - `payload[1-4]` = date (must match packet 0)
  - `payload[5-11]` = distance, sport duration, sleep duration
  - **End Condition**: `packetIndex == 1` (fixed 2 packets)

**Packet Index Validation**:
- **Heart Rate/HRV/Pressure**: Index must match expected sequence (0x00, 0x01, 0x02, ...)
- **Sleep/Sport**: Index validation: `packetIndex == totalPackets - 1` indicates last packet
- **Error Handling**: If index mismatch, response object set to null, return false


### 16.10 Stop/Disable Commands

**StopHeartRateReq** (Opcode 0x6A/106):

**Payload Format**:
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Type       | uint8  | Measurement type (1=HR, 2=BP, 3=SpO₂, etc.)
1      | 1    | Parameter  | uint8  | Type-specific parameter
2      | 1    | Reserved   | uint8  | Always 0 (or parameter for BP)
```

**Factory Methods**:
- `stopHeartRate(byte param)` - Type 1, stops HR measurement
- `stopBloodPressure(byte param1, byte param2)` - Type 2, stops BP measurement
- `stopBloodOxygen(byte param)` - Type 3, stops SpO₂ measurement
- `stopFatigue(byte param)` - Type 4, stops fatigue measurement
- `stopHealthCheck()` - Type 5, stops health check
- `stopEcg(int param)` - Type 7, stops ECG measurement
- `stopPressure(byte param)` - Type 8, stops pressure measurement
- `stopBloodSugar(byte param)` - Type 9, stops blood sugar measurement
- `stopHrv(byte param)` - Type 10, stops HRV measurement
- `stopTemperatureCheck()` - Type 11, stops temperature check

**StopHeartRateRsp** (Response):
```
Offset | Size | Field      | Type   | Description
-------|------|------------|--------|-------------
0      | 1    | Type       | uint8  | Measurement type
1      | 1    | ErrCode    | uint8  | Error code (0=success)
2      | 1    | Value      | uint8  | Last measured value
3      | 1    | SBP        | uint8  | Systolic BP (if applicable, >=5 bytes)
4      | 1    | DBP        | uint8  | Diastolic BP (if applicable, >=5 bytes)
```

**Auto-Stop Behavior**:
- **Real-time HR**: Streams continuously until `StopHeartRateReq` sent
- **No auto-stop observed**: Streams continue until explicitly stopped
- **Device-initiated stop**: Not observed in code (may timeout on device side)


### 16.11 Status/Error Code Meanings

**BaseRspCmd.getStatus()**:
- **0 = Success**: All handlers check `status == 0` before processing
- **Non-zero = Error**: Exact error codes not explicitly documented in code

**Usage Pattern**:
```java
if (resultEntity.getStatus() == 0 && resultEntity.getDataType() == EXPECTED_TYPE) {
    // Process data
}
```

**StopHeartRateRsp.getErrCode()**:
- **0 = Success**: Measurement stopped successfully
- **Non-zero = Error**: Error stopping measurement

**StartHeartRateRsp.getErrCode()**:
- **0 = Success**: Measurement started successfully
- **Non-zero = Error**: Error starting measurement

**Recovery Actions**:
- **Status != 0**: Handler ignores notification, no retry
- **No explicit retry logic**: App does not automatically retry failed commands
- **Reconnect**: On disconnect, app reconnects (up to 10 attempts)
- **State reset**: On reconnect, command state cleared


### 16.12 Large Data Service Usage

**Service UUIDs**:
- Service: `de5bf728-d711-4e47-af26-65e3012a5dc7`
- TX: `de5bf729-d711-4e47-af26-65e3012a5dc7` (write)
- RX: `de5bf72a-d711-4e47-af26-65e3012a5dc7` (notify)

**Features Using Large Data Service**:
- **File Transfers**: Album images, ebook files, audio files, video files
- **Contact Sync**: Contact list transfer
- **Sleep Data (New Protocol)**: `SleepNewProtoResp` via large data
- **Temperature Data**: Interval temperature measurements
- **Heart Rate Data**: Interval heart rate measurements
- **Blood Oxygen Data**: Interval SpO₂ measurements
- **Sport Plus Data**: Detailed sport session data
- **DFU (Device Firmware Update)**: Firmware update transfers

**Frame Validation**:
- **Header Check**: `data[0] == 0xBC` (188)
- **Length Check**: `data.length >= 6` (minimum frame size)
- **Length Field**: Bytes 2-3 = payload length (little-endian short)
- **CRC16**: Bytes 4-5 = CRC16 checksum (little-endian short)
- **Validation**: `LargeDataParser.parseBigLargeData()` validates header and length

**Reassembly Rules**:
- **Incomplete Frames**: Buffered in `f26144a` until complete
- **Complete Check**: `data.length - 6 == length` (header + length + CRC + payload)
- **Sequence**: No explicit sequence numbers, relies on length field
- **Retransmission**: Not explicitly handled, relies on BLE reliability

**Command Byte** (data[1]):
- 0x31-0x33: File transfer commands (album, ebook, music)
- 0x35-0x39: Health data commands (temperature, HR, SpO₂, etc.)
- 0x42, 0x44, 0x45, 0x46, 0x48, 0x49, 0x4A: Sport plus commands
- 0x4A, 0x4B: Avatar/image commands
- 0x7E, 0x7F: File transfer end markers
- 0x80, 0x81: File transfer ACK/NACK

**CRC16 Coverage**:
- **Polynomial**: 0xA001 (CRC-16-IBM reversed)
- **Initial Value**: 0xFFFF
- **Coverage**: Payload only (bytes 6+), not header/length/CRC fields


### 16.13 Device Model / Firmware Differences

**Model Detection**:
- **Scan Filter**: Models listed in scan config: `R01,R02,R03,VK-5098,MERLIN,Hello Ring,RING1,boAtring,R04,R05,R06,R11,Y25,H59`
- **No explicit model checks**: Code does not show model-specific payload variations
- **Feature Gating**: `DeviceSupportFunctionRsp` indicates supported features per model

**RingTouchOnly Mode**:
- **Flag**: `DeviceSupportFunctionRsp.C` (byte 5, all bits)
- **Effect**: If true, uses alternate feature mapping (byte 5 fields override byte 2)
- **Models**: Likely ring variants (R01-R11) vs band variants (Y25, H59)

**Firmware Differences**:
- **App Revision Query**: `AppRevisionReq` (opcode 0xA1) queries firmware version
- **Response**: `AppRevisionResp` with `dataType` and `result` fields
- **No version-specific logic**: Code does not show firmware version checks affecting protocol

**Payload Format Consistency**:
- **Same opcodes**: All models use same opcode values
- **Same framing**: 16-byte standard frames, 0xBC large data frames
- **Feature differences**: Only feature availability differs, not protocol structure


### 16.14 Time Semantics

**Timestamp Format**:
- **Type**: uint32 (4 bytes, little-endian)
- **Unit**: Unix epoch seconds
- **Timezone**: UTC on wire, adjusted by device timezone on response

**Timezone Handling**:
- **Device Timezone**: Queried via `TimeZone.getDefault().getOffset(System.currentTimeMillis()) / 3600000.0f`
- **Adjustment**: `timestamp -= (timezoneOffset * 3600)` (convert hours to seconds)
- **Consistency**: All history responses adjust timestamps by device timezone

**Timestamp Semantics**:
- **Interval Start**: Timestamps represent start of measurement interval
- **Heart Rate**: 5-minute intervals (288 samples/day)
- **HRV**: 30-minute intervals (default)
- **Pressure**: Per-measurement (not fixed intervals)
- **Sleep**: 5-minute intervals (timeIndex 0-287 per day)
- **Sport**: Per-interval (timeIndex indicates interval)

**Drift Behavior**:
- **Device Clock**: Synced via `SetTimeReq` (opcode 0x01)
- **Sync Frequency**: Not explicitly scheduled, done on connection
- **Drift Handling**: Not explicitly handled, assumes device clock stays synchronized
- **Today Detection**: Uses `DateUtil.isToday()` to filter future data

**BCD Date Format** (Sleep/Sport):
- **Year**: BCD byte + 2000 (e.g., 0x24 = 2024)
- **Month**: BCD byte (1-12)
- **Day**: BCD byte (1-31)
- **Time Index**: Raw byte (0-287 for 5-min intervals, varies for other intervals)

**Date Offset** (HRV/Pressure):
- **Day Offset**: Byte indicating days ago (0=today, 1=yesterday, etc.)
- **Calculation**: `DateUtil.addDay(-dayOffset)` to get target date
- **Range**: Typically 0-29 days (sleep supports up to 29 days ago)
